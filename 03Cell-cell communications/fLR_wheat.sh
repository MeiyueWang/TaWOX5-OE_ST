fasta_formatter -i uniprot_prot_wheat.fasta -t |sed 's/ /_/g;s/|/\t/g' |sort -k4,4 |join -t $'\t' -1 4 -2 2 - <(fasta_formatter -i <(cat /data/wangmeiyue/genome/iwgsc_v1.0/iwgsc_refseqv1.1_genes_2017July06/IWGSC_v1.1_HC_20170706_pep.fasta |sed 's/ /_/g') -t |awk 'BEGIN{FS=OFS="\t"}gsub("\\.","",$2){print $0}' |sort -k2,2) |awk 'BEGIN{FS=OFS="\t"}{print $3,$5}' |sed 's/_gene=/\t/g' |sort -k1,1 >uniprot_prot_id_to_iwgsc_id.txt
fasta_formatter -i <(cat uniprotkb_KW_0964_AND_organism_id_4565_2024_05_22.fasta uniprotkb_KW_1003_AND_organism_id_4565_2024_05_22.fasta) -t |cut -f1 |sed 's/|/\t/g' |awk 'BEGIN{FS=OFS="\t"}{print $2}' |sort -u >uniprot_receptor.txt
cat string_4565.protein.links.v12.0.txt |tail -n +2 |sed 's/4565.//g;s/ /\t/g' |awk 'BEGIN{FS=OFS="\t"}{if($3>=600)print $0}' |sort -k1,1 >string_PPI_sel.txt
join -t $'\t' -1 1 -2 1 uniprot_receptor.txt string_PPI_sel.txt >receptor_ligate.txt
join -t $'\t' -1 1 -2 1 receptor_ligate.txt uniprot_prot_id_to_iwgsc_id.txt |awk 'BEGIN{FS=OFS="\t"}{print $2,$5}' |sort -k1,1 |join -t $'\t' -1 1 -2 1 - uniprot_prot_id_to_iwgsc_id.txt |awk 'BEGIN{FS=OFS="\t"}{print $4,$2,"STRING","Triticum_aestivum"}' |sed '1i Ligands\tReceptors\tsource\tOrganism' >LR_pair_wheat.txt
